
# 如何编写正确的C代码

> *作者：Arvin 日期：2017年4月10日*

---------------------------------

>BEGIN

正确的编写C代码需要从C的优缺点讲起，所谓扬长避短。C的优点，无非是性能优异、数据操作灵活和移植性高；C的缺点也显而易见，数据和方法没有封装、指针和数组没有检验存在安全性问题和学习难度大。

### 一、利用优点
---------------------------------
1. 性能优异，使用C自带该属性，但是在操作上还是进一步优化的，比如：使用移位操作代替部分乘除操作。
2. 数据操作灵活，大部分是针对指针来讲的，C的指针可以操作底层数据并且很容易传递。利用好指针代码可以写的很精简，并且内存可以重用。
3. 移植性高，避免使用平台api，尽量使用标准C，支持跨平台。
4. 结构化设计，设计好数据表和数据结构来简化操作代码。
5. 模块化设计，各个模块数据和方法尽量在一起，提高模块独立性；模块之间的接口尽量简单，接口数据结构尽量简单。
6. 数据引擎+人机接口方法，引擎处理核心的通用业务逻辑和数据，对UI层提供数据驱动和数据返回接口。
7. 脚本语言方法，嵌入脚本引擎，让开发更加简单。
8. 使用组合复用代替继承复用。

### 二、避免缺点
---------------------------------
1. 数据和操作无封装，都是全局的，导致阅读困难，不知道方法和数据的定义地方。好的封装应该把方法与数据进行关联，那个方法操作那个数据结构。全局代表没有层次结构，会引起代码混乱，并且在运行时数据的状态不好控制，方法不能重名。尽量体现数据和方法的层次结构，做到数据跟方法关联。
2. 指针和数组无校验，指针不要维度太深最多三层，数组要传递和校验长度，数组维度不要超过三层。指针和数组数据及时释放。尽量使用堆而非栈，使用栈需要校验长度。
3. 学习难度大，学习C代码尽量从全局入手，因为C的数据和方法都会全局的。从业务模型入手，理解原理。使用好指针和递归。常量基本与业务相关。数据分为数据抽象，即运行时动态数据，业务常量数据，即业务数据。

>END

